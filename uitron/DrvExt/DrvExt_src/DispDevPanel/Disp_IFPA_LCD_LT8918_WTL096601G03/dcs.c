#include "dcs.h"
#include "LT8918_Int.h"
#include "Delay.h"

static UINT8 Sleep_Out[] ={0x05,0x11,0x00}; //sleep_out
static UINT8 Display_On[]={0x05,0x29,0x00}; //display on
//static UINT8 Additional_code[] = {0x32,0x00,0x00};

static void DcsPktWrite(UINT8 DCS_DI, UINT8 Len, UINT8* Ptr )
{
	UINT8 i = 0;

	LT8918_SetRegBank(0x83);
	LT8918_WriteReg(0x40,0x04); //Tx hs data MSB/LSB polarity select

	if( Len == 2 )
	{
		LT8918_WriteReg(0x32,0x0C); //Hardware calculate ecc and crc&LP mode send pkt enable&Short pkt
		LT8918_WriteReg(0x33,0x04);
		LT8918_WriteReg(0x34,DCS_DI);
		LT8918_WriteReg(0x34,*Ptr );
		LT8918_WriteReg(0x34,*(Ptr+1));
		LT8918_WriteReg(0x32,0x00);
	}
	else
	{
		LT8918_WriteReg(0x32,0x0E); //Hardware calculate ecc and crc&LP mode send pkt enable& Long pkt
		LT8918_WriteReg(0x33,(Len+6)); //pkt data length
		LT8918_WriteReg(0x34,DCS_DI);      //Data_ID
		LT8918_WriteReg(0x34,Len);         //data lenth_L
		LT8918_WriteReg(0x34,0x00);        //data lenth_H

		for( i = 0; i < Len; i++ )
		{
			LT8918_WriteReg(0x34,*Ptr);
			Ptr++;
		}
		LT8918_WriteReg(0x32,0x00);
	}
}

#if 0
static void dcs_write_4P(UINT8 data1,UINT8 data2,UINT8 data3,UINT8 data4)
{
	UINT8	dcs[4];
	dcs[0]=data1;
	dcs[1]=data2;
	dcs[2]=data3;
	dcs[3]=data4;
	DcsPktWrite(LPDT_LPK,4,&dcs[0]);
}

static void dcs_write_3P(UINT8 data1,UINT8 data2,UINT8 data3)
{
	UINT8	dcs[3];
	dcs[0]=data1;
	dcs[1]=data2;
	dcs[2]=data3;
	DcsPktWrite(LPDT_LPK,3,&dcs[0]);
}
#endif

static void dcs_write_2P(UINT8 data0,UINT8 data1)
{
	UINT8	dcs[2];
	dcs[0]=data0;
	dcs[1]=data1;
	DcsPktWrite(LPDT_SPK,2,&dcs[0]);
}

void Panel_Init(void)
{
//	UINT8 temp = 0;
//	unsigned int dcslen=0,t=0;
//	vdLCD_RSTN();
//	vdLT8918L_I2c_Enable();
	LT8918_SetRegBank(0x70);
//	LT8918_WriteReg(0x23,0xa0);
//	LT8918_WriteReg(0x29,0x81);
	LT8918_WriteReg(0x38,0x00);
	LT8918_WriteReg(0x34,0x49);
	LT8918_WriteReg(0x35,0x80);
	LT8918_SetRegBank(0x83);
	LT8918_WriteReg(0x11,0x00);

//	for(t=0;t<=CMDNUM;t++)
//	{
//		dcslen=cmdlen[t];
//		if(dcslen==2)  DcsPktWrite(LPDT_SPK,dcslen, cmdlist[t]);//short
//		else
//		if(dcslen>2)   DcsPktWrite(LPDT_LPK,dcslen, cmdlist[t]);//long
//	}

dcs_write_2P(0xB0,0x5A);//#4T

dcs_write_2P(0xB1,0x00);
dcs_write_2P(0x89,0x01);
dcs_write_2P(0x91,0x17);
dcs_write_2P(0xB1,0x03);
dcs_write_2P(0x2C,0x28);

dcs_write_2P(0x00,0xF1);
dcs_write_2P(0x01,0x18);
dcs_write_2P(0x02,0x00);
dcs_write_2P(0x03,0x00);
dcs_write_2P(0x04,0x00);
dcs_write_2P(0x05,0x00);
dcs_write_2P(0x06,0x00);
dcs_write_2P(0x07,0x00);
dcs_write_2P(0x08,0x00);
dcs_write_2P(0x09,0x00);
dcs_write_2P(0x0A,0x01);
dcs_write_2P(0x0B,0x01);
dcs_write_2P(0x0C,0x00);
dcs_write_2P(0x0D,0x00);
dcs_write_2P(0x0E,0x24);
dcs_write_2P(0x0F,0x1C);
dcs_write_2P(0x10,0xC9);
dcs_write_2P(0x11,0x60);
dcs_write_2P(0x12,0x70);
dcs_write_2P(0x13,0x01);
dcs_write_2P(0x14,0xE7);
dcs_write_2P(0x15,0xFF);
dcs_write_2P(0x16,0x3D);
dcs_write_2P(0x17,0x0E);
dcs_write_2P(0x18,0x01);
dcs_write_2P(0x19,0x00);
dcs_write_2P(0x1A,0x00);
dcs_write_2P(0x1B,0xFC);
dcs_write_2P(0x1C,0x0B);
dcs_write_2P(0x1D,0xA0);
dcs_write_2P(0x1E,0x03);
dcs_write_2P(0x1F,0x04);
dcs_write_2P(0x20,0x0C);
dcs_write_2P(0x21,0x00);
dcs_write_2P(0x22,0x04);
dcs_write_2P(0x23,0x81);
dcs_write_2P(0x24,0x1F);
dcs_write_2P(0x25,0x10);
dcs_write_2P(0x26,0x9B);
dcs_write_2P(0x2D,0x01);
dcs_write_2P(0x2E,0x84);
dcs_write_2P(0x2F,0x00);
dcs_write_2P(0x30,0x02);
dcs_write_2P(0x31,0x08);
dcs_write_2P(0x32,0x01);
dcs_write_2P(0x33,0x1C);
dcs_write_2P(0x34,0x40);
dcs_write_2P(0x35,0xFF);
dcs_write_2P(0x36,0xFF);
dcs_write_2P(0x37,0xFF);
dcs_write_2P(0x38,0xFF);
dcs_write_2P(0x39,0xFF);
dcs_write_2P(0x3A,0x05);
dcs_write_2P(0x3B,0x00);
dcs_write_2P(0x3C,0x00);
dcs_write_2P(0x3D,0x00);
dcs_write_2P(0x3E,0x0F);
dcs_write_2P(0x3F,0x8C);
dcs_write_2P(0x40,0x2A);
dcs_write_2P(0x41,0xFC);
dcs_write_2P(0x42,0x01);
dcs_write_2P(0x43,0x40);
dcs_write_2P(0x44,0x05);
dcs_write_2P(0x45,0xE8);
dcs_write_2P(0x46,0x16);
dcs_write_2P(0x47,0x00);
dcs_write_2P(0x48,0x00);
dcs_write_2P(0x49,0x88);
dcs_write_2P(0x4A,0x08);
dcs_write_2P(0x4B,0x05);
dcs_write_2P(0x4C,0x03);
dcs_write_2P(0x4D,0xD0);
dcs_write_2P(0x4E,0x13);
dcs_write_2P(0x4F,0xFF);
dcs_write_2P(0x50,0x0A);
dcs_write_2P(0x51,0x53);
dcs_write_2P(0x52,0x26);
dcs_write_2P(0x53,0x22);
dcs_write_2P(0x54,0x09);
dcs_write_2P(0x55,0x22);
dcs_write_2P(0x56,0x00);
dcs_write_2P(0x57,0x1C);
dcs_write_2P(0x58,0x03);
dcs_write_2P(0x59,0x3F);
dcs_write_2P(0x5A,0x28);
dcs_write_2P(0x5B,0x01);
dcs_write_2P(0x5C,0xCC);
dcs_write_2P(0x5D,0x21);
dcs_write_2P(0x5E,0x84);
dcs_write_2P(0x5F,0x84);
dcs_write_2P(0x60,0x8E);
dcs_write_2P(0x61,0x89);
dcs_write_2P(0x62,0xF0);
dcs_write_2P(0x63,0xB9);
dcs_write_2P(0x64,0xC6);
dcs_write_2P(0x65,0x96);
dcs_write_2P(0x66,0x0A);
dcs_write_2P(0x67,0x62);
dcs_write_2P(0x68,0x90);
dcs_write_2P(0x69,0x12);
dcs_write_2P(0x6A,0x42);
dcs_write_2P(0x6B,0x48);
dcs_write_2P(0x6C,0xE8);
dcs_write_2P(0x6D,0x98);
dcs_write_2P(0x6E,0x08);
dcs_write_2P(0x6F,0x9F);
dcs_write_2P(0x70,0x6B);
dcs_write_2P(0x71,0x6C);
dcs_write_2P(0x72,0xA9);
dcs_write_2P(0x73,0x20);
dcs_write_2P(0x74,0x06);
dcs_write_2P(0x75,0x29);
dcs_write_2P(0x76,0x00);
dcs_write_2P(0x77,0x00);
dcs_write_2P(0x78,0x0F);
dcs_write_2P(0x79,0xE0);
dcs_write_2P(0x7A,0x01);
dcs_write_2P(0x7B,0xFF);
dcs_write_2P(0x7C,0xFF);
dcs_write_2P(0x7D,0xFF);
dcs_write_2P(0x7E,0x4F);
dcs_write_2P(0x7F,0xFE);


dcs_write_2P(0xB1,0x02);

dcs_write_2P(0x00,0xFF);
dcs_write_2P(0x01,0x05);
dcs_write_2P(0x02,0xA0);
dcs_write_2P(0x03,0x00);
dcs_write_2P(0x04,0x54);
dcs_write_2P(0x05,0x38);
dcs_write_2P(0x06,0xA0);
dcs_write_2P(0x07,0x0A);
dcs_write_2P(0x08,0xC0);//#40
dcs_write_2P(0x09,0x00);
dcs_write_2P(0x0A,0x00);
dcs_write_2P(0x0B,0x14);
dcs_write_2P(0x0C,0xE6);
dcs_write_2P(0x0D,0x0D);
dcs_write_2P(0x0F,0x08);//#00
dcs_write_2P(0x10,0x79);//#Gamma
dcs_write_2P(0x11,0x38);
dcs_write_2P(0x12,0x73);
dcs_write_2P(0x13,0xB3);
dcs_write_2P(0x14,0x29);
dcs_write_2P(0x15,0x80);
dcs_write_2P(0x16,0x07);
dcs_write_2P(0x17,0x8A);
dcs_write_2P(0x18,0x8D);
dcs_write_2P(0x19,0xBF);
dcs_write_2P(0x1A,0x69);
dcs_write_2P(0x1B,0x0E);//#Gamma
dcs_write_2P(0x1C,0xFF);
dcs_write_2P(0x1D,0xFF);
dcs_write_2P(0x1E,0xFF);
dcs_write_2P(0x1F,0xFF);
dcs_write_2P(0x20,0xFF);
dcs_write_2P(0x21,0xFF);
dcs_write_2P(0x22,0xFF);
dcs_write_2P(0x23,0xFF);
dcs_write_2P(0x24,0xFF);
dcs_write_2P(0x25,0xFF);
dcs_write_2P(0x26,0xFF);
dcs_write_2P(0x27,0x1F);
dcs_write_2P(0x28,0xFF);
dcs_write_2P(0x29,0xFF);
dcs_write_2P(0x2A,0xFF);
dcs_write_2P(0x2B,0xFF);
dcs_write_2P(0x2C,0xFF);
dcs_write_2P(0x2D,0x07);
dcs_write_2P(0x33,0x06);
dcs_write_2P(0x35,0x7E);
dcs_write_2P(0x36,0x06);
dcs_write_2P(0x38,0x7E);
dcs_write_2P(0x3A,0x80);
dcs_write_2P(0x3B,0x01);
dcs_write_2P(0x3C,0x00);
dcs_write_2P(0x3D,0x2A);
dcs_write_2P(0x3E,0x00);
dcs_write_2P(0x3F,0x40);
dcs_write_2P(0x40,0x05);
dcs_write_2P(0x41,0x00);
dcs_write_2P(0x42,0xA8);
dcs_write_2P(0x43,0x00);
dcs_write_2P(0x44,0x00);
dcs_write_2P(0x45,0x05);
dcs_write_2P(0x46,0x00);
dcs_write_2P(0x47,0x00);
dcs_write_2P(0x48,0x9B);//#8B
dcs_write_2P(0x49,0xD2);
dcs_write_2P(0x4A,0x81);
dcs_write_2P(0x4B,0x02);//#42
dcs_write_2P(0x4C,0x15);//#16
dcs_write_2P(0x4D,0xC0);
dcs_write_2P(0x4E,0x0F);
dcs_write_2P(0x4F,0x61);
dcs_write_2P(0x50,0x78);
dcs_write_2P(0x51,0x7A);
dcs_write_2P(0x52,0x34);
dcs_write_2P(0x53,0x99);
dcs_write_2P(0x54,0xA2);
dcs_write_2P(0x55,0x02);
dcs_write_2P(0x56,0x14);
dcs_write_2P(0x57,0xB8);
dcs_write_2P(0x58,0xDC);
dcs_write_2P(0x59,0x34);
dcs_write_2P(0x5A,0x1E);
dcs_write_2P(0x5B,0x8F);
dcs_write_2P(0x5C,0xC7);
dcs_write_2P(0x5D,0xE3);
dcs_write_2P(0x5E,0xF1);
dcs_write_2P(0x5F,0x78);
dcs_write_2P(0x60,0x3C);
dcs_write_2P(0x61,0x36);
dcs_write_2P(0x62,0x1E);
dcs_write_2P(0x63,0x1B);
dcs_write_2P(0x64,0x8F);
dcs_write_2P(0x65,0xC7);
dcs_write_2P(0x66,0xE3);
dcs_write_2P(0x67,0x31);
dcs_write_2P(0x68,0x0C);
dcs_write_2P(0x69,0x89);
dcs_write_2P(0x6A,0x30);
dcs_write_2P(0x6B,0x8C);
dcs_write_2P(0x6C,0x8D);
dcs_write_2P(0x6D,0x8D);
dcs_write_2P(0x6E,0x8D);
dcs_write_2P(0x6F,0x8D);
dcs_write_2P(0x70,0xC7);
dcs_write_2P(0x71,0xE3);
dcs_write_2P(0x72,0x31);
dcs_write_2P(0x73,0x00);
dcs_write_2P(0x74,0x00);
dcs_write_2P(0x75,0x00);
dcs_write_2P(0x76,0x00);
dcs_write_2P(0x77,0x00);
dcs_write_2P(0x78,0x00);
dcs_write_2P(0x79,0x00);
dcs_write_2P(0x7A,0xC6);
dcs_write_2P(0x7B,0xC6);
dcs_write_2P(0x7C,0xC6);
dcs_write_2P(0x7D,0xC6);
dcs_write_2P(0x7E,0xC6);
dcs_write_2P(0x7F,0xE3);
dcs_write_2P(0x0B,0x00);

dcs_write_2P(0xB1,0x03);
dcs_write_2P(0x2C,0x2C);

dcs_write_2P(0xB1,0x00);
dcs_write_2P(0x89,0x03);

DcsPktWrite( Sleep_Out[0], ( sizeof( Sleep_Out ) - 1 ), &Sleep_Out[1] );
Delay_DelayMs(120);
DcsPktWrite( Display_On[0], ( sizeof( Display_On ) - 1 ), &Display_On[1] );
Delay_DelayMs(20);
//DcsPktWrite( Additional_code[0], ( sizeof( Additional_code ) - 1 ), &Additional_code[1] );
//Delay_DelayMs(20);
}
